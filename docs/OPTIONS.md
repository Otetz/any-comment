# Общие параметры запросов

Оглавление
----------

* [Пагинация](#Пагинация)
* [Фильтрация по дате/времени](#Фильтрация-по-датевремени)
* [Формат выдачи](#Формат-выдачи)

## Пагинация

Ко всем списковым запросам можно применять параметры пагинации в строке запроса.

**Параметры**:
- **page** `?page={int}` — Опеределяет номер страницы резльтатов, по умолчанию 1
- **per_page** `?per_page={int}` — Определяет количество результатов на одной странице, по умолчанию 10. Максимальное 
  значение 100
- **offset** `?offset={int}` — Начало отсчета для страницы, вычисляемое, если определено в запросе то праметр `page` 
  (номер страницы) игнорируется
 
**Примеры запросов**:
```bash
curl -X GET http://HOSTNAME/api/1.0/comments/?page=2
```
```bash
curl -X GET http://HOSTNAME/api/1.0/comments/?page=4\&per_page=5
```
```bash
curl -X GET http://HOSTNAME/api/1.0/comments/?offset=10
```

## Фильтрация по дате/времени

К любым спискам комментариев можно применить фильтрацию по дате/времени создния комментария. Можно применять как оба 
параметра (тогда результат будет в диапазоне), так и не указывать их (тогда фильтр по дате не применяется).

**Параметры**:
- **after** `?after={datetime}` — Задаёт дату **после** которой был создан комментарий. Формат даты/времени может быть 
  любой, принимаемый методом :method:`dateutil.parser.parse`.
- **before** `?before={datetime}` — Задаёт дату **до** которой был создан комментарий. Формат даты/времени может быть 
  любой, принимаемый методом :method:`dateutil.parser.parse`.

**Пример запроса**:
```bash
curl -X GET http://HOSTNAME/api/1.0/comments/320283/descendants?after=2017-06-10%2012:00:00
```

## Формат выдачи

Любой из списков можно получить в виде скачиваемого файла в одном из трёх форматов:
* JSON — `.json` в конце URI ресурса (до параметров)
* CSV — `.csv` в конце URI ресурса (применяется кодировка windows-1251, для упрощённого импорта в MicroSoft Excel)
* XML — `.xml` в конце URI ресурса

**Примеры ответов**:  
XML:
```xml
<?xml version="1.0" encoding="utf-8"?>
<response>
<record>
	<datetime>2017-06-20 18:51:58.950570+03:00</datetime>
	<parentid>321028</parentid>
	<deleted>False</deleted>
	<text>Парадигма программирования — это совокупность идей и понятий, определяющих…</text>
	<entityid>321068</entityid>
	<author>
		<userid>322</userid>
		<name>Аполлинарий Селезнёв</name>
	</author>
	<commentid>320323</commentid>
</record>
<record>
	<datetime>2017-06-20 18:51:58.950570+03:00</datetime>
	<parentid>321028</parentid>
	<deleted>False</deleted>
	<text>Erlang — функциональный язык программирования с сильной динамической типизацией, …</text>
	<entityid>321069</entityid>
	<author>
		<userid>331</userid>
		<name>Валерия Николаева</name>
	</author>
	<commentid>320324</commentid>
</record>
</response>
```
CSV:
```csv
entityid;author_name;datetime;commentid;parentid;deleted;author_userid;text
321068;Аполлинарий Селезнёв;2017-06-20 18:51:58.950570+03:00;320323;321028;0;322;Парадигма программирования — это совокупность идей и понятий, определяющих стиль …
321069;Валерия Николаева;2017-06-20 18:51:58.950570+03:00;320324;321028;0;331;Erlang — функциональный язык программирования с сильной динамической типизацией, …
```